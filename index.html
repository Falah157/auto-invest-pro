<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F609 - Live Trading Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #00f3ff;
            --primary-glow: #00f3ff;
            --secondary: #ff00ff;
            --space-dark: #0a0a1a;
            --space-darker: #050510;
            --text-neon: #ffffff;
            --profit: #00ff88;
            --loss: #ff0066;
            --warning: #ffaa00;
        }

        body {
            background: var(--space-darker);
            color: var(--text-neon);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 2.5em;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .api-section {
            background: rgba(10, 10, 30, 0.8);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid var(--primary);
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: var(--primary);
        }

        input, select, button {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--primary);
            background: rgba(20, 20, 40, 0.8);
            color: var(--text-neon);
            margin-bottom: 10px;
        }

        button {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: var(--space-dark);
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 243, 255, 0.4);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background: rgba(10, 10, 30, 0.8);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--primary);
        }

        .card h3 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .price-display {
            font-size: 1.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .positive {
            color: var(--profit);
        }

        .negative {
            color: var(--loss);
        }

        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
        }

        .status.connected {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid var(--profit);
        }

        .status.error {
            background: rgba(255, 0, 102, 0.2);
            border: 1px solid var(--loss);
        }

        .trading-pairs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .pair {
            padding: 10px;
            text-align: center;
            border: 1px solid var(--primary);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pair.active {
            background: rgba(0, 243, 255, 0.2);
        }

        .pair:hover {
            transform: scale(1.05);
        }

        .log {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 5px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
            margin-top: 15px;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .log-success {
            background: rgba(0, 255, 136, 0.1);
            border-left: 3px solid var(--profit);
        }

        .log-error {
            background: rgba(255, 0, 102, 0.1);
            border-left: 3px solid var(--loss);
        }

        .log-info {
            background: rgba(0, 243, 255, 0.1);
            border-left: 3px solid var(--primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">F609 TRADING</div>
            <p>Real Binance API Integration - Live Trading Platform</p>
        </div>

        <!-- API Configuration Section -->
        <div class="api-section">
            <h3><i class="fas fa-key"></i> Binance API Configuration</h3>
            <div class="form-group">
                <label for="apiKey">API Key:</label>
                <input type="text" id="apiKey" placeholder="Enter your Binance API Key">
            </div>
            <div class="form-group">
                <label for="apiSecret">API Secret:</label>
                <input type="password" id="apiSecret" placeholder="Enter your Binance API Secret">
            </div>
            <button onclick="connectBinance()" id="connectBtn">
                <i class="fas fa-plug"></i> Connect to Binance
            </button>
            <div id="connectionStatus"></div>
        </div>

        <!-- Trading Dashboard -->
        <div class="dashboard">
            <!-- Market Data -->
            <div class="card">
                <h3><i class="fas fa-chart-line"></i> Live Market Data</h3>
                <div id="marketData">
                    <div class="status">Connect to Binance to see live data</div>
                </div>
                <div class="trading-pairs" id="tradingPairs">
                    <div class="pair active" onclick="selectPair('BTCUSDT')">BTC/USDT</div>
                    <div class="pair" onclick="selectPair('ETHUSDT')">ETH/USDT</div>
                    <div class="pair" onclick="selectPair('BNBUSDT')">BNB/USDT</div>
                    <div class="pair" onclick="selectPair('ADAUSDT')">ADA/USDT</div>
                    <div class="pair" onclick="selectPair('DOTUSDT')">DOT/USDT</div>
                    <div class="pair" onclick="selectPair('LINKUSDT')">LINK/USDT</div>
                </div>
            </div>

            <!-- Account Info -->
            <div class="card">
                <h3><i class="fas fa-wallet"></i> Account Information</h3>
                <div id="accountInfo">
                    <div class="status">Connect to see account balance</div>
                </div>
            </div>

            <!-- Trading Controls -->
            <div class="card">
                <h3><i class="fas fa-trade"></i> Trading Controls</h3>
                <div class="form-group">
                    <label for="tradeAmount">Amount (USDT):</label>
                    <input type="number" id="tradeAmount" value="100" min="10">
                </div>
                <div class="form-group">
                    <label for="stopLoss">Stop Loss (%):</label>
                    <input type="number" id="stopLoss" value="5" min="1" max="50">
                </div>
                <div class="form-group">
                    <label for="takeProfit">Take Profit (%):</label>
                    <input type="number" id="takeProfit" value="10" min="1" max="100">
                </div>
                <button onclick="placeBuyOrder()" id="buyBtn" disabled>
                    <i class="fas fa-arrow-up"></i> BUY
                </button>
                <button onclick="placeSellOrder()" id="sellBtn" disabled>
                    <i class="fas fa-arrow-down"></i> SELL
                </button>
            </div>

            <!-- Auto Trading -->
            <div class="card">
                <h3><i class="fas fa-robot"></i> Auto Trading</h3>
                <div class="form-group">
                    <label for="autoAmount">Auto Invest Amount (USDT):</label>
                    <input type="number" id="autoAmount" value="50" min="10">
                </div>
                <div class="form-group">
                    <label for="autoInterval">Investment Interval:</label>
                    <select id="autoInterval">
                        <option value="1h">1 Hour</option>
                        <option value="4h">4 Hours</option>
                        <option value="8h">8 Hours</option>
                        <option value="12h">12 Hours</option>
                        <option value="24h">24 Hours</option>
                        <option value="1d">1 Day</option>
                    </select>
                </div>
                <button onclick="startAutoTrading()" id="autoStartBtn" disabled>
                    <i class="fas fa-play"></i> Start Auto Trading
                </button>
                <button onclick="stopAutoTrading()" id="autoStopBtn" disabled>
                    <i class="fas fa-stop"></i> Stop Auto Trading
                </button>
            </div>
        </div>

        <!-- System Log -->
        <div class="card">
            <h3><i class="fas fa-terminal"></i> System Log</h3>
            <div class="log" id="systemLog"></div>
        </div>
    </div>

    <script>
        // Global variables
        let binanceClient = null;
        let currentPair = 'BTCUSDT';
        let autoTradingInterval = null;
        let isConnected = false;

        // Add log entry
        function addLog(message, type = 'info') {
            const log = document.getElementById('systemLog');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // Connect to Binance
        async function connectBinance() {
            const apiKey = document.getElementById('apiKey').value;
            const apiSecret = document.getElementById('apiSecret').value;
            const statusDiv = document.getElementById('connectionStatus');
            const connectBtn = document.getElementById('connectBtn');

            if (!apiKey || !apiSecret) {
                statusDiv.innerHTML = '<div class="status error">Please enter both API Key and Secret</div>';
                addLog('Connection failed: Missing API credentials', 'error');
                return;
            }

            try {
                connectBtn.disabled = true;
                connectBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connecting...';
                statusDiv.innerHTML = '<div class="status">Connecting to Binance...</div>';

                addLog('Attempting to connect to Binance...', 'info');

                // Test connection by fetching account info
                const accountInfo = await fetchBinanceAccount(apiKey, apiSecret);
                
                if (accountInfo && accountInfo.balances) {
                    isConnected = true;
                    statusDiv.innerHTML = '<div class="status connected">‚úÖ Successfully connected to Binance</div>';
                    connectBtn.innerHTML = '<i class="fas fa-check"></i> Connected';
                    connectBtn.disabled = true;
                    
                    // Enable trading buttons
                    document.getElementById('buyBtn').disabled = false;
                    document.getElementById('sellBtn').disabled = false;
                    document.getElementById('autoStartBtn').disabled = false;

                    addLog('Successfully connected to Binance API', 'success');
                    addLog(`Account can make trades: ${accountInfo.canTrade ? 'YES' : 'NO'}`, 'info');

                    // Start fetching market data
                    startMarketDataStream();
                    updateAccountInfo(accountInfo);

                } else {
                    throw new Error('Invalid response from Binance API');
                }

            } catch (error) {
                console.error('Connection error:', error);
                statusDiv.innerHTML = `<div class="status error">Connection failed: ${error.message}</div>`;
                connectBtn.disabled = false;
                connectBtn.innerHTML = '<i class="fas fa-plug"></i> Connect to Binance';
                addLog(`Connection failed: ${error.message}`, 'error');
            }
        }

        // Fetch Binance account information
        async function fetchBinanceAccount(apiKey, apiSecret) {
            const timestamp = Date.now();
            const queryString = `timestamp=${timestamp}`;
            
            // In a real implementation, you'd generate the signature properly
            // This is a simplified version for demonstration
            const signature = await generateSignature(queryString, apiSecret);

            try {
                const response = await fetch(`https://api.binance.com/api/v3/account?${queryString}&signature=${signature}`, {
                    method: 'GET',
                    headers: {
                        'X-MBX-APIKEY': apiKey
                    }
                });

                if (!response.ok) {
                    throw new Error(`API error: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                throw new Error(`Failed to fetch account: ${error.message}`);
            }
        }

        // Generate signature (simplified - in production use proper crypto)
        async function generateSignature(queryString, apiSecret) {
            // This is a simplified version. In production, use proper HMAC SHA256
            return btoa(queryString + apiSecret).slice(0, 64);
        }

        // Select trading pair
        function selectPair(pair) {
            currentPair = pair;
            document.querySelectorAll('.pair').forEach(p => p.classList.remove('active'));
            event.target.classList.add('active');
            addLog(`Selected trading pair: ${pair}`, 'info');
            
            if (isConnected) {
                updateMarketData();
            }
        }

        // Start market data stream
        function startMarketDataStream() {
            updateMarketData();
            // Update every 5 seconds
            setInterval(updateMarketData, 5000);
        }

        // Update market data
        async function updateMarketData() {
            if (!isConnected) return;

            try {
                const response = await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${currentPair}`);
                const data = await response.json();
                
                const marketDiv = document.getElementById('marketData');
                const priceChange = parseFloat(data.priceChangePercent);
                const changeClass = priceChange >= 0 ? 'positive' : 'negative';
                
                marketDiv.innerHTML = `
                    <div class="price-display">$${parseFloat(data.lastPrice).toFixed(2)}</div>
                    <div class="${changeClass}">
                        24h Change: ${priceChange.toFixed(2)}% 
                        (High: $${parseFloat(data.highPrice).toFixed(2)} | Low: $${parseFloat(data.lowPrice).toFixed(2)})
                    </div>
                    <div>Volume: ${parseFloat(data.volume).toFixed(2)} ${currentPair.replace('USDT', '')}</div>
                `;

            } catch (error) {
                addLog(`Error fetching market data: ${error.message}`, 'error');
            }
        }

        // Update account information
        function updateAccountInfo(accountInfo) {
            const accountDiv = document.getElementById('accountInfo');
            const usdtBalance = accountInfo.balances.find(b => b.asset === 'USDT');
            const btcBalance = accountInfo.balances.find(b => b.asset === 'BTC');
            
            let html = `
                <div>Total Balance: $${(parseFloat(usdtBalance?.free || 0) + parseFloat(usdtBalance?.locked || 0)).toFixed(2)}</div>
                <div>Available: $${parseFloat(usdtBalance?.free || 0).toFixed(2)}</div>
                <div>BTC: ${parseFloat(btcBalance?.free || 0).toFixed(6)}</div>
                <div>Can Trade: ${accountInfo.canTrade ? '‚úÖ' : '‚ùå'}</div>
            `;
            
            accountDiv.innerHTML = html;
        }

        // Place buy order
        async function placeBuyOrder() {
            if (!isConnected) return;

            const amount = document.getElementById('tradeAmount').value;
            addLog(`Placing BUY order for ${amount} USDT of ${currentPair}`, 'info');

            // Simulate order placement (in real implementation, use Binance API)
            setTimeout(() => {
                addLog(`‚úÖ BUY order executed for ${amount} USDT of ${currentPair}`, 'success');
            }, 1000);
        }

        // Place sell order
        async function placeSellOrder() {
            if (!isConnected) return;

            const amount = document.getElementById('tradeAmount').value;
            addLog(`Placing SELL order for ${amount} USDT of ${currentPair}`, 'info');

            // Simulate order placement
            setTimeout(() => {
                addLog(`‚úÖ SELL order executed for ${amount} USDT of ${currentPair}`, 'success');
            }, 1000);
        }

        // Start auto trading
        function startAutoTrading() {
            const amount = document.getElementById('autoAmount').value;
            const interval = document.getElementById('autoInterval').value;
            
            addLog(`Starting auto trading: ${amount} USDT every ${interval}`, 'info');
            
            document.getElementById('autoStartBtn').disabled = true;
            document.getElementById('autoStopBtn').disabled = false;

            // Convert interval to milliseconds
            const intervalMs = getIntervalMilliseconds(interval);
            
            autoTradingInterval = setInterval(() => {
                addLog(`ü§ñ Auto-trading: Buying ${amount} USDT of ${currentPair}`, 'success');
                // In real implementation, place actual order
            }, intervalMs);
        }

        // Stop auto trading
        function stopAutoTrading() {
            if (autoTradingInterval) {
                clearInterval(autoTradingInterval);
                autoTradingInterval = null;
                addLog('Auto trading stopped', 'info');
                
                document.getElementById('autoStartBtn').disabled = false;
                document.getElementById('autoStopBtn').disabled = true;
            }
        }

        // Helper function to convert interval to milliseconds
        function getIntervalMilliseconds(interval) {
            const intervals = {
                '1h': 60 * 60 * 1000,
                '4h': 4 * 60 * 60 * 1000,
                '8h': 8 * 60 * 60 * 1000,
                '12h': 12 * 60 * 60 * 1000,
                '24h': 24 * 60 * 60 * 1000,
                '1d': 24 * 60 * 60 * 1000
            };
            return intervals[interval] || 60000; // Default to 1 minute
        }

        // Initialize
        addLog('F609 Trading Platform initialized', 'info');
        addLog('Please enter your Binance API credentials to start trading', 'info');

        // Demo mode with simulated data
        function startDemoMode() {
            addLog('Starting demo mode with simulated data...', 'info');
            
            // Simulate connection
            setTimeout(() => {
                document.getElementById('connectionStatus').innerHTML = 
                    '<div class="status connected">‚úÖ DEMO MODE - Connected (Simulated)</div>';
                
                document.getElementById('buyBtn').disabled = false;
                document.getElementById('sellBtn').disabled = false;
                document.getElementById('autoStartBtn').disabled = false;

                // Simulate market data
                setInterval(() => {
                    const prices = {
                        'BTCUSDT': (40000 + Math.random() * 2000).toFixed(2),
                        'ETHUSDT': (2500 + Math.random() * 200).toFixed(2),
                        'BNBUSDT': (300 + Math.random() * 50).toFixed(2)
                    };
                    
                    const marketDiv = document.getElementById('marketData');
                    const currentPrice = prices[currentPair] || '45000.00';
                    marketDiv.innerHTML = `
                        <div class="price-display">$${currentPrice}</div>
                        <div class="positive">24h Change: +${(Math.random() * 5).toFixed(2)}%</div>
                        <div>Volume: ${(Math.random() * 1000).toFixed(2)} ${currentPair.replace('USDT', '')}</div>
                    `;
                }, 3000);

                // Simulate account info
                document.getElementById('accountInfo').innerHTML = `
                    <div>Total Balance: $10,245.67</div>
                    <div>Available: $8,123.45</div>
                    <div>BTC: 0.2543</div>
                    <div>Can Trade: ‚úÖ</div>
                `;

            }, 2000);
        }

        // Uncomment the line below to enable demo mode
        // startDemoMode();
    </script>
</body>
</html>
