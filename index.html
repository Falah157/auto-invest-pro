<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üèóÔ∏è KANDITHEEMU ROAD PROJECT - Complete Monitoring System</title>
    <style>
        /* Previous CSS remains, adding new styles for new features */
        
        /* Technical Data Styles */
        .technical-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .tech-item {
            background: var(--light);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        
        .tech-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary);
            margin: 5px 0;
        }
        
        .tech-label {
            font-size: 11px;
            color: var(--text-light);
            text-transform: uppercase;
        }
        
        /* Financial Dashboard */
        .financial-summary {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .cost-breakdown {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        /* Quality Control */
        .qc-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .qc-pass { background: #e8f5e9; color: var(--success); }
        .qc-fail { background: #ffebee; color: var(--danger); }
        .qc-pending { background: #fff3e0; color: var(--warning); }
        
        /* Timeline View */
        .timeline {
            position: relative;
            padding-left: 30px;
            margin: 20px 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding: 10px;
            background: var(--light);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 15px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary);
        }
        
        /* Boat Schedule */
        .boat-schedule {
            background: linear-gradient(135deg, #01579b 0%, #0277bd 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        /* Enhanced Tables */
        .enhanced-table {
            width: 100%;
            font-size: 13px;
        }
        
        .enhanced-table th {
            background: var(--dark);
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .enhanced-table td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
        }
        
        .enhanced-table tr:nth-child(even) {
            background: var(--light);
        }
        
        /* Progress Timeline */
        .milestone-tracker {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            position: relative;
        }
        
        .milestone {
            text-align: center;
            flex: 1;
            position: relative;
        }
        
        .milestone.completed .milestone-dot {
            background: var(--success);
            border-color: var(--success);
        }
        
        .milestone.in-progress .milestone-dot {
            background: var(--warning);
            border-color: var(--warning);
            animation: pulse 2s infinite;
        }
        
        .milestone.pending .milestone-dot {
            background: var(--light);
            border-color: var(--border);
        }
        
        .milestone-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid var(--border);
            margin: 0 auto 10px;
            position: relative;
            z-index: 2;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 152, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 152, 0, 0); }
        }
        
        /* Tide Chart */
        .tide-chart {
            height: 100px;
            background: linear-gradient(to bottom, #e3f2fd, #bbdefb);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .tide-wave {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: linear-gradient(to top, #2196f3, #64b5f6);
            border-radius: 50% 50% 0 0;
            animation: wave 10s infinite linear;
        }
        
        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100px); }
        }
        
        /* Environmental Log */
        .environment-log {
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        /* Emergency Protocols */
        .emergency-card {
            background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }
        
        /* New Navigation */
        .sub-nav {
            display: flex;
            overflow-x: auto;
            gap: 5px;
            margin: 15px 0;
            padding-bottom: 10px;
        }
        
        .sub-nav-btn {
            padding: 8px 16px;
            background: var(--light);
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 12px;
            white-space: nowrap;
            cursor: pointer;
        }
        
        .sub-nav-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Data Export Options */
        .export-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .export-btn {
            padding: 12px;
            background: var(--light);
            border: 1px solid var(--border);
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .export-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }
        
        /* Photo Documentation */
        .photo-doc {
            position: relative;
            margin: 10px 0;
        }
        
        .photo-meta {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px;
            font-size: 11px;
        }
        
        /* Signature Capture */
        .signature-pad {
            width: 100%;
            height: 150px;
            border: 2px dashed var(--border);
            border-radius: 8px;
            background: var(--light);
            margin: 15px 0;
            touch-action: none;
        }
        
        /* Daily Summary Card */
        .daily-summary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .summary-item {
            text-align: center;
        }
        
        .summary-value {
            font-size: 24px;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .summary-label {
            font-size: 11px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- App Container -->
    <div id="app">
        <!-- Enhanced Header -->
        <header class="app-header">
            <div class="header-top">
                <div class="app-title">
                    <span>üèóÔ∏è KANDITHEEMU ROAD PROJECT</span>
                </div>
                <div class="project-info">
                    Phase 2 - Main Road Construction<br>
                    <small>Contract: GDC/KTD/2024/001</small>
                </div>
            </div>
            
            <!-- Enhanced Weather & Tide Widget -->
            <div class="weather-widget">
                <div style="display: flex; justify-content: space-between; width: 100%;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="weather-icon">üå§Ô∏è</div>
                        <div class="weather-details">
                            <div class="weather-temp">30¬∞C</div>
                            <div class="weather-condition">Partly Cloudy ‚Ä¢ Tide: High @ 14:30</div>
                        </div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 12px; opacity: 0.8;">
                            <div>üìÖ Day 45 of 180</div>
                            <div>üïí 08:45 AM</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('operations')">üèóÔ∏è Operations</button>
                <button class="tab" onclick="switchTab('technical')">üìê Technical</button>
                <button class="tab" onclick="switchTab('financial')">üí∞ Financial</button>
                <button class="tab" onclick="switchTab('labor')">üë∑ Labor</button>
                <button class="tab" onclick="switchTab('logistics')">üöö Logistics</button>
                <button class="tab" onclick="switchTab('compliance')">üìã Compliance</button>
            </div>
        </header>

        <!-- Operations Dashboard -->
        <div id="operations-content" class="container">
            <!-- Daily Summary -->
            <div class="daily-summary">
                <h3 style="margin-bottom: 15px;">üìä TODAY'S SUMMARY</h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-value" id="workers-today">24</div>
                        <div class="summary-label">Workers On Site</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="meters-done">85</div>
                        <div class="summary-label">Meters Completed</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="incidents-today">0</div>
                        <div class="summary-label">Safety Incidents</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-value" id="cost-today">$2,450</div>
                        <div class="summary-label">Today's Cost</div>
                    </div>
                </div>
            </div>

            <!-- Sub Navigation -->
            <div class="sub-nav">
                <button class="sub-nav-btn active" onclick="showOperationsSub('daily')">üìù Daily Ops</button>
                <button class="sub-nav-btn" onclick="showOperationsSub('progress')">üìà Progress</button>
                <button class="sub-nav-btn" onclick="showOperationsSub('equipment')">üîß Equipment</button>
                <button class="sub-nav-btn" onclick="showOperationsSub('communications')">üìû Communications</button>
                <button class="sub-nav-btn" onclick="showOperationsSub('environment')">üå¥ Environment</button>
            </div>

            <!-- Daily Operations -->
            <div id="daily-ops">
                <div class="quick-actions">
                    <button class="action-btn" onclick="openSiteInspection()">
                        <div class="action-icon" style="background: #E8F5E9; color: var(--success);">üìê</div>
                        <div class="action-text">Site Inspection</div>
                    </button>
                    
                    <button class="action-btn" onclick="openWorkerAttendance()">
                        <div class="action-icon" style="background: #E3F2FD; color: var(--secondary);">üë∑</div>
                        <div class="action-text">Worker Attendance</div>
                    </button>
                    
                    <button class="action-btn" onclick="openEquipmentCheck()">
                        <div class="action-icon" style="background: #FFF3E0; color: var(--warning);">üîß</div>
                        <div class="action-text">Equipment Check</div>
                    </button>
                    
                    <button class="action-btn" onclick="openMaterialDelivery()">
                        <div class="action-icon" style="background: #F3E5F5; color: #7B1FA2);">üì¶</div>
                        <div class="action-text">Material Delivery</div>
                    </button>
                    
                    <button class="action-btn" onclick="openQualityTests()">
                        <div class="action-icon" style="background: #E0F2F1; color: #00796B;">üß™</div>
                        <div class="action-text">Quality Tests</div>
                    </button>
                    
                    <button class="action-btn" onclick="openProgressMeasurement()">
                        <div class="action-icon" style="background: #FFF8E1; color: #FF8F00;">üìè</div>
                        <div class="action-text">Progress Measurement</div>
                    </button>
                    
                    <button class="action-btn" onclick="openSafetyInspection()">
                        <div class="action-icon" style="background: #FFEBEE; color: var(--danger);">üõ°Ô∏è</div>
                        <div class="action-text">Safety Inspection</div>
                    </button>
                    
                    <button class="action-btn" onclick="openEnvironmentalCheck()">
                        <div class="action-icon" style="background: #E8F5E9; color: #2E7D32);">üåø</div>
                        <div class="action-text">Environmental Check</div>
                    </button>
                    
                    <button class="action-btn" onclick="openDailyCosting()">
                        <div class="action-icon" style="background: #F3E5F5; color: #7B1FA2);">üí∞</div>
                        <div class="action-text">Daily Costing</div>
                    </button>
                </div>

                <!-- Critical Alerts -->
                <div class="section-card" style="border-left: 4px solid var(--danger);">
                    <div class="section-header">
                        <div class="section-title">üö® CRITICAL ALERTS</div>
                        <span class="item-status status-delayed">2 Pending</span>
                    </div>
                    <div class="section-body">
                        <div class="list-item">
                            <div class="item-info">
                                <div class="item-title">‚ö†Ô∏è Cement stock low (3 days left)</div>
                                <div class="item-subtitle">Order needed by tomorrow</div>
                            </div>
                            <button class="btn btn-outline" style="padding: 6px 12px; font-size: 12px;" onclick="orderMaterial()">Order Now</button>
                        </div>
                        <div class="list-item">
                            <div class="item-info">
                                <div class="item-title">‚ö†Ô∏è Excavator service overdue</div>
                                <div class="item-subtitle">Due for 100-hour service</div>
                            </div>
                            <button class="btn btn-outline" style="padding: 6px 12px; font-size: 12px;" onclick="scheduleService()">Schedule</button>
                        </div>
                    </div>
                </div>

                <!-- Today's Timeline -->
                <div class="section-card">
                    <div class="section-header">
                        <div class="section-title">üïí TODAY'S TIMELINE</div>
                    </div>
                    <div class="section-body">
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="item-title">06:30 - Site Preparation</div>
                                <div class="item-subtitle">Clearing work area, safety barriers setup</div>
                            </div>
                            <div class="timeline-item">
                                <div class="item-title">08:00 - Excavation Work</div>
                                <div class="item-subtitle">Section 4 (50m) drainage trench</div>
                            </div>
                            <div class="timeline-item">
                                <div class="item-title">10:00 - Material Delivery</div>
                                <div class="item-subtitle">Cement (100 bags), Sand (5m¬≥)</div>
                            </div>
                            <div class="timeline-item">
                                <div class="item-title">13:00 - Concrete Pouring</div>
                                <div class="item-subtitle">Drainage base concrete (Section 4)</div>
                            </div>
                            <div class="timeline-item">
                                <div class="item-title">15:00 - Quality Checks</div>
                                <div class="item-subtitle">Slump test, compaction test</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Boat Schedule -->
                <div class="boat-schedule">
                    <div class="section-header" style="border-bottom: 1px solid rgba(255,255,255,0.2); padding: 0 0 10px 0;">
                        <div class="section-title" style="color: white;">‚õ¥Ô∏è BOAT SCHEDULE (Male' - Kanditheemu)</div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                        <div>
                            <div style="font-size: 11px; opacity: 0.8;">Today's Arrivals</div>
                            <div style="font-size: 14px; margin-top: 5px;">‚Ä¢ MV Thundi (09:30) - Construction Materials</div>
                            <div style="font-size: 14px;">‚Ä¢ Speed Boat (14:00) - Engineers Visit</div>
                        </div>
                        <div>
                            <div style="font-size: 11px; opacity: 0.8;">Tomorrow</div>
                            <div style="font-size: 14px; margin-top: 5px;">‚Ä¢ MV Coral (08:00) - Steel, Pipes</div>
                            <div style="font-size: 14px;">‚Ä¢ Supply Boat (16:00) - Fuel, Equipment</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Tracking -->
            <div id="progress-tracking" style="display: none;">
                <div class="section-card">
                    <div class="section-header">
                        <div class="section-title">üìà PROJECT PROGRESS TRACKER</div>
                    </div>
                    <div class="section-body">
                        <!-- Milestone Tracker -->
                        <div class="milestone-tracker">
                            <div class="milestone completed">
                                <div class="milestone-dot"></div>
                                <div style="font-size: 12px;">Survey</div>
                                <div style="font-size: 10px; color: var(--text-light);">Day 1-7</div>
                            </div>
                            <div class="milestone completed">
                                <div class="milestone-dot"></div>
                                <div style="font-size: 12px;">Clearing</div>
                                <div style="font-size: 10px; color: var(--text-light);">Day 8-14</div>
                            </div>
                            <div class="milestone in-progress">
                                <div class="milestone-dot"></div>
                                <div style="font-size: 12px;">Drainage</div>
                                <div style="font-size: 10px; color: var(--text-light);">Day 15-60</div>
                            </div>
                            <div class="milestone pending">
                                <div class="milestone-dot"></div>
                                <div style="font-size: 12px;">Road Base</div>
                                <div style="font-size: 10px; color: var(--text-light);">Day 61-100</div>
                            </div>
                            <div class="milestone pending">
                                <div class="milestone-dot"></div>
                                <div style="font-size: 12px;">Paving</div>
                                <div style="font-size: 10px; color: var(--text-light);">Day 101-140</div>
                            </div>
                            <div class="milestone pending">
                                <div class="milestone-dot"></div>
                                <div style="font-size: 12px;">Finishing</div>
                                <div style="font-size: 10px; color: var(--text-light);">Day 141-180</div>
                            </div>
                        </div>

                        <!-- Technical Progress -->
                        <div class="technical-grid">
                            <div class="tech-item">
                                <div class="tech-value">1.2 km</div>
                                <div class="tech-label">Total Length</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">350 m</div>
                                <div class="tech-label">Completed</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">29%</div>
                                <div class="tech-label">Overall Progress</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">45 days</div>
                                <div class="tech-label">Elapsed Time</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">135 days</div>
                                <div class="tech-label">Remaining</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">7.8 m/day</div>
                                <div class="tech-label">Average Rate</div>
                            </div>
                        </div>

                        <!-- Section-wise Progress -->
                        <div style="margin-top: 20px;">
                            <div style="font-weight: 600; margin-bottom: 10px;">Section-wise Progress</div>
                            <div class="progress-container">
                                <div class="progress-label">
                                    <span>Section 1: School Road (200m)</span>
                                    <span>85%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 85%"></div>
                                </div>
                            </div>
                            <div class="progress-container">
                                <div class="progress-label">
                                    <span>Section 2: Market Road (300m)</span>
                                    <span>45%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 45%"></div>
                                </div>
                            </div>
                            <div class="progress-container">
                                <div class="progress-label">
                                    <span>Section 3: Residential (400m)</span>
                                    <span>15%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 15%"></div>
                                </div>
                            </div>
                            <div class="progress-container">
                                <div class="progress-label">
                                    <span>Section 4: Coastal (300m)</span>
                                    <span>5%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 5%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Technical Dashboard -->
        <div id="technical-content" class="container" style="display: none;">
            <div class="sub-nav">
                <button class="sub-nav-btn active" onclick="showTechnicalSub('survey')">üìê Survey Data</button>
                <button class="sub-nav-btn" onclick="showTechnicalSub('qc')">üß™ Quality Control</button>
                <button class="sub-nav-btn" onclick="showTechnicalSub('measurements')">üìè Measurements</button>
                <button class="sub-nav-btn" onclick="showTechnicalSub('drawings')">üìã Drawings</button>
                <button class="sub-nav-btn" onclick="showTechnicalSub('specs')">üìÑ Specifications</button>
            </div>

            <!-- Survey Data -->
            <div id="survey-data">
                <div class="section-card">
                    <div class="section-header">
                        <div class="section-title">üìê SURVEY DATA & COORDINATES</div>
                        <button class="btn btn-outline" style="padding: 8px 16px; font-size: 12px;" onclick="captureGPS()">üìç Capture GPS</button>
                    </div>
                    <div class="section-body">
                        <table class="enhanced-table">
                            <thead>
                                <tr>
                                    <th>Point</th>
                                    <th>Latitude</th>
                                    <th>Longitude</th>
                                    <th>Elevation</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>PK 0+000</td>
                                    <td>6.5321¬∞ N</td>
                                    <td>73.0654¬∞ E</td>
                                    <td>1.2m</td>
                                    <td>2024-01-15</td>
                                    <td><span class="qc-status qc-pass">Verified</span></td>
                                </tr>
                                <tr>
                                    <td>PK 0+200</td>
                                    <td>6.5325¬∞ N</td>
                                    <td>73.0658¬∞ E</td>
                                    <td>1.5m</td>
                                    <td>2024-01-15</td>
                                    <td><span class="qc-status qc-pass">Verified</span></td>
                                </tr>
                                <tr>
                                    <td>PK 0+400</td>
                                    <td>6.5330¬∞ N</td>
                                    <td>73.0662¬∞ E</td>
                                    <td>1.8m</td>
                                    <td>2024-01-20</td>
                                    <td><span class="qc-status qc-pending">Pending</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Quality Control Tests -->
                <div class="section-card">
                    <div class="section-header">
                        <div class="section-title">üß™ QUALITY CONTROL TESTS</div>
                        <button class="btn btn-primary" style="padding: 8px 16px; font-size: 12px;" onclick="recordQCTest()">+ New Test</button>
                    </div>
                    <div class="section-body">
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                            <div class="tech-item">
                                <div class="tech-value">85 mm</div>
                                <div class="tech-label">Avg. Slump Test</div>
                                <div style="font-size: 11px; color: var(--success);">Within spec (75-100mm)</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">95%</div>
                                <div class="tech-label">Compaction</div>
                                <div style="font-size: 11px; color: var(--success);">Meets requirement</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">25 MPa</div>
                                <div class="tech-label">Concrete Strength</div>
                                <div style="font-size: 11px; color: var(--success);">Test after 7 days</div>
                            </div>
                            <div class="tech-item">
                                <div class="tech-value">2%</div>
                                <div class="tech-label">Moisture Content</div>
                                <div style="font-size: 11px; color: var(--warning);">Slightly high</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Financial Dashboard -->
        <div id="financial-content" class="container" style="display: none;">
            <div class="financial-summary">
                <h3 style="margin-bottom: 15px;">üí∞ FINANCIAL SUMMARY</h3>
                <div style="display: flex; justify-content: space-between;">
                    <div>
                        <div style="font-size: 11px; opacity: 0.8;">Total Budget</div>
                        <div style="font-size: 28px; font-weight: bold;">$850,000</div>
                    </div>
                    <div>
                        <div style="font-size: 11px; opacity: 0.8;">Spent to Date</div>
                        <div style="font-size: 28px; font-weight: bold;">$245,300</div>
                    </div>
                    <div>
                        <div style="font-size: 11px; opacity: 0.8;">Remaining</div>
                        <div style="font-size: 28px; font-weight: bold;">$604,700</div>
                    </div>
                </div>
                
                <div class="progress-container" style="margin-top: 20px;">
                    <div class="progress-label" style="color: white;">
                        <span>Budget Utilization</span>
                        <span>29%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 29%"></div>
                    </div>
                </div>
            </div>

            <div class="cost-breakdown">
                <div class="section-card">
                    <div class="section-header">
                        <div class="section-title">üë∑ Labor Costs</div>
                    </div>
                    <div class="section-body">
                        <div class="tech-item">
                            <div class="tech-value">$125,400</div>
                            <div class="tech-label">Total Labor Cost</div>
                        </div>
                        <div style="margin-top: 10px;">
                            <div style="font-size: 12px; color: var(--text-light);">Daily Average: $2,800</div>
                            <div style="font-size: 12px; color: var(--text-light);">Workers: 24 @ $25/day</div>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <div class="section-title">üì¶ Materials</div>
                    </div>
                    <div class="section-body">
                        <div class="tech-item">
                            <div class="tech-value">$85,600</div>
                            <div class="tech-label">Material Cost</div>
                        </div>
                        <div style="margin-top: 10px;">
                            <div style="font-size: 12px; color: var(--text-light);">Cement: $32,000</div>
                            <div style="font-size: 12px; color: var(--text-light);">Steel: $28,500</div>
                            <div style="font-size: 12px; color: var(--text-light);">Aggregates: $25,100</div>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <div class="section-header">
                        <div class="section-title">üîß Equipment</div>
                    </div>
                    <div class="section-body">
                        <div class="tech-item">
                            <div class="tech-value">$34,300</div>
                            <div class="tech-label">Equipment Cost</div>
                        </div>
                        <div style="margin-top: 10px;">
                            <div style="font-size: 12px; color: var(--text-light);">Excavator: $15,000</div>
                            <div style="font-size: 12px; color: var(--text-light);">Roller: $8,500</div>
                            <div style="font-size: 12px; color: var(--text-light);">Generator: $4,800</div>
                            <div style="font-size: 12px; color: var(--text-light);">Fuel: $6,000</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Additional sections for Labor, Logistics, Compliance would follow similar structure -->

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="switchMainTab('operations')">
                <span class="nav-icon">üèóÔ∏è</span>
                <span>Operations</span>
            </button>
            <button class="nav-item" onclick="switchMainTab('technical')">
                <span class="nav-icon">üìê</span>
                <span>Technical</span>
            </button>
            <button class="nav-item" onclick="switchMainTab('financial')">
                <span class="nav-icon">üí∞</span>
                <span>Financial</span>
            </button>
            <button class="nav-item" onclick="switchMainTab('reports')">
                <span class="nav-icon">üìä</span>
                <span>Reports</span>
            </button>
            <button class="nav-item" onclick="switchMainTab('more')">
                <span class="nav-icon">‚ãØ</span>
                <span>More</span>
            </button>
        </nav>
    </div>

    <!-- MODALS FOR ALL NEW FEATURES -->
    
    <!-- Site Inspection Modal -->
    <div class="modal-overlay" id="site-inspection-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üìê DAILY SITE INSPECTION</div>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Comprehensive inspection form -->
                <div class="form-group">
                    <label class="form-label">Inspection Time</label>
                    <input type="datetime-local" class="form-input" id="inspection-time">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Weather Conditions</label>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                        <button class="btn btn-outline" onclick="setWeather('sunny')">‚òÄÔ∏è Sunny</button>
                        <button class="btn btn-outline" onclick="setWeather('cloudy')">‚òÅÔ∏è Cloudy</button>
                        <button class="btn btn-outline" onclick="setWeather('rainy')">üåßÔ∏è Rainy</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tide Level (for coastal work)</label>
                    <select class="form-select" id="tide-level">
                        <option value="low">‚¨áÔ∏è Low Tide</option>
                        <option value="mid">‚ÜîÔ∏è Mid Tide</option>
                        <option value="high">‚¨ÜÔ∏è High Tide</option>
                        <option value="spring">üåä Spring Tide</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Work Area Readiness</label>
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <div class="item-info">
                            <div class="item-title">Area properly cleared and leveled</div>
                            <div class="item-subtitle">No debris, vegetation cleared</div>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <div class="item-info">
                            <div class="item-title">Safety barriers and signage in place</div>
                            <div class="item-subtitle">Warning signs visible to public</div>
                        </div>
                    </div>
                    
                    <div class="checklist-item">
                        <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                        <div class="item-info">
                            <div class="item-title">Access roads clear for equipment</div>
                            <div class="item-subtitle">No obstacles for machinery movement</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">GPS Coordinates</label>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                        <input type="text" class="form-input" id="gps-lat" placeholder="Latitude">
                        <input type="text" class="form-input" id="gps-long" placeholder="Longitude">
                    </div>
                    <button class="btn btn-outline" style="margin-top: 10px;" onclick="getCurrentLocation()">üìç Get Current Location</button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Inspection Photos</label>
                    <div class="photo-grid">
                        <div class="photo-item" onclick="takeInspectionPhoto('overall')">üì∑ Overall</div>
                        <div class="photo-item" onclick="takeInspectionPhoto('details')">üîç Details</div>
                        <div class="photo-item" onclick="takeInspectionPhoto('issues')">‚ö†Ô∏è Issues</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Issues Found</label>
                    <textarea class="form-textarea" id="inspection-issues" placeholder="List any problems found..." rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Corrective Actions</label>
                    <textarea class="form-textarea" id="corrective-actions" placeholder="Actions to be taken..." rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Inspector's Signature</label>
                    <div class="signature-pad" id="signature-pad"></div>
                    <button class="btn btn-outline" style="margin-top: 10px;" onclick="clearSignature()">Clear Signature</button>
                </div>
                
                <button class="btn btn-primary" onclick="saveSiteInspection()">
                    üíæ Save Inspection Report
                </button>
            </div>
        </div>
    </div>

    <!-- Worker Attendance Modal -->
    <div class="modal-overlay" id="worker-attendance-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">üë∑ WORKER ATTENDANCE & PAYROLL</div>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Comprehensive worker management form -->
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" class="form-input" id="attendance-date">
                </div>
                
                <div style="margin: 20px 0;">
                    <div style="font-weight: 600; margin-bottom: 10px;">Worker Categories</div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                        <div class="tech-item">
                            <div class="tech-value" id="skilled-count">8</div>
                            <div class="tech-label">Skilled</div>
                        </div>
                        <div class="tech-item">
                            <div class="tech-value" id="unskilled-count">12</div>
                            <div class="tech-label">Unskilled</div>
                        </div>
                        <div class="tech-item">
                            <div class="tech-value" id="operator-count">4</div>
                            <div class="tech-label">Operators</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Worker List (Tick present workers)</label>
                    <div style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border); border-radius: 8px; padding: 10px;">
                        <!-- Worker list would be loaded dynamically -->
                        <div class="checklist-item">
                            <div class="checklist-checkbox" onclick="toggleCheck(this)"></div>
                            <div class="item-info">
                                <div class="item-title">Ahmed Rasheed (Operator)</div>
                                <div class="item-subtitle">Excavator, Roller</div>
                            </div>
                            <div style="font-weight: 600;">$30/day</div>
                        </div>
                        <!-- More workers... -->
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Hours Worked (if different from standard)</label>
                    <input type="number" class="form-input" id="hours-worked" placeholder="Standard: 8 hours" min="1" max="12">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Overtime Hours</label>
                    <input type="number" class="form-input" id="overtime-hours" placeholder="Overtime hours">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Daily Wage Calculation</label>
                    <div style="background: var(--light); padding: 15px; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>Total Workers:</span>
                            <span id="total-workers">24</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <span>Total Wages:</span>
                            <span id="total-wages">$2,400</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <span>Overtime:</span>
                            <span id="overtime-cost">$0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-top: 5px; font-weight: 600; border-top: 1px solid var(--border); padding-top: 5px;">
                            <span>Daily Total:</span>
                            <span id="daily-total">$2,400</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Notes (Absences, injuries, etc.)</label>
                    <textarea class="form-textarea" id="attendance-notes" placeholder="Any notes..." rows="2"></textarea>
                </div>
                
                <button class="btn btn-primary" onclick="saveWorkerAttendance()">
                    üë∑ Save Attendance & Payroll
                </button>
            </div>
        </div>
    </div>

    <!-- Add more modals for Equipment Check, Quality Tests, Progress Measurement, etc. -->

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
        // =================== COMPREHENSIVE APP STATE ===================
        let currentMainTab = 'operations';
        let currentSubTab = 'daily';
        let projectData = {
            operations: {},
            technical: {},
            financial: {},
            labor: {},
            logistics: {},
            compliance: {},
            // ... more categories
        };
        
        // =================== INITIALIZATION ===================
        document.addEventListener('DOMContentLoaded', function() {
            initializeComprehensiveApp();
            loadOperationsData();
            updateRealTimeData();
            setInterval(updateRealTimeData, 60000);
            
            // Initialize signature pad if needed
            initializeSignaturePad();
        });
        
        function initializeComprehensiveApp() {
            // Load comprehensive data structure
            const savedData = localStorage.getItem('kanditheemu_project_data');
            
            if (savedData) {
                projectData = JSON.parse(savedData);
            } else {
                // Initialize with comprehensive default data
                projectData = {
                    projectInfo: {
                        name: "Kanditheemu Main Road Development Phase 2",
                        contractNo: "GDC/KTD/2024/001",
                        startDate: "2024-01-01",
                        endDate: "2024-06-30",
                        totalLength: 1200, // meters
                        totalBudget: 850000, // USD
                        client: "Kanditheemu Island Council",
                        contractor: "GDC Construction",
                        projectManager: "Ahmed Rasheed",
                        siteEngineer: "Ibrahim Mohamed"
                    },
                    
                    operations: {
                        dailyLogs: [],
                        inspections: [],
                        equipmentLogs: [],
                        safetyIncidents: [],
                        progressMeasurements: [],
                        weatherLogs: [],
                        tideData: []
                    },
                    
                    technical: {
                        surveyPoints: [],
                        qualityTests: [],
                        drawings: [],
                        specifications: [],
                        measurements: [],
                        asBuiltData: []
                    },
                    
                    financial: {
                        budgetBreakdown: {
                            labor: 350000,
                            materials: 300000,
                            equipment: 150000,
                            overheads: 50000
                        },
                        expenses: [],
                        invoices: [],
                        payments: [],
                        dailyCosts: []
                    },
                    
                    labor: {
                        workers: [
                            { id: 1, name: "Ahmed Rasheed", role: "Operator", rate: 30, category: "skilled" },
                            { id: 2, name: "Ibrahim Mohamed", role: "Foreman", rate: 35, category: "skilled" },
                            // ... more workers
                        ],
                        attendance: [],
                        payroll: [],
                        training: [],
                        incidents: []
                    },
                    
                    logistics: {
                        materialOrders: [],
                        deliveries: [],
                        boatSchedule: [],
                        inventory: [],
                        equipment: []
                    },
                    
                    compliance: {
                        permits: [],
                        inspections: [],
                        environmental: [],
                        community: [],
                        reports: []
                    },
                    
                    timeline: {
                        milestones: [
                            { id: 1, name: "Survey Complete", date: "2024-01-07", status: "completed" },
                            { id: 2, name: "Clearing Complete", date: "2024-01-14", status: "completed" },
                            { id: 3, name: "Drainage 50%", date: "2024-02-15", status: "in-progress" },
                            { id: 4, name: "Drainage Complete", date: "2024-03-15", status: "pending" },
                            // ... more milestones
                        ],
                        criticalPath: []
                    },
                    
                    documents: {
                        photos: [],
                        reports: [],
                        certificates: [],
                        communications: []
                    }
                };
            }
            
            saveComprehensiveData();
        }
        
        // =================== MAIN FUNCTIONS ===================
        
        function switchMainTab(tab) {
            currentMainTab = tab;
            
            // Hide all main content sections
            document.querySelectorAll('.container').forEach(container => {
                container.style.display = 'none';
            });
            
            // Show selected tab content
            document.getElementById(tab + '-content').style.display = 'block';
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Load appropriate data
            switch(tab) {
                case 'operations':
                    loadOperationsData();
                    break;
                case 'technical':
                    loadTechnicalData();
                    break;
                case 'financial':
                    loadFinancialData();
                    break;
                case 'labor':
                    loadLaborData();
                    break;
                case 'logistics':
                    loadLogisticsData();
                    break;
                case 'compliance':
                    loadComplianceData();
                    break;
            }
            
            showToast(`Switched to ${tab} dashboard`, 'info');
        }
        
        function showOperationsSub(sub) {
            currentSubTab = sub;
            
            // Hide all operation subs
            document.querySelectorAll('#operations-content > div[id]').forEach(div => {
                div.style.display = 'none';
            });
            
            // Show selected sub
            document.getElementById(sub).style.display = 'block';
            
            // Update sub navigation
            document.querySelectorAll('.sub-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        function showTechnicalSub(sub) {
            // Similar implementation for technical sub-tabs
            // ...
        }
        
        // =================== DATA LOADING FUNCTIONS ===================
        
        function loadOperationsData() {
            // Update daily summary
            const today = new Date().toISOString().split('T')[0];
            const todayWorkers = projectData.labor.attendance
                .filter(a => a.date === today)
                .reduce((sum, a) => sum + a.present, 0);
            
            document.getElementById('workers-today').textContent = todayWorkers || 24;
            
            // Calculate meters completed today
            const todayProgress = projectData.operations.progressMeasurements
                .filter(p => p.date === today)
                .reduce((sum, p) => sum + (p.meters || 0), 0);
            
            document.getElementById('meters-done').textContent = todayProgress || 85;
            
            // Update incidents
            const todayIncidents = projectData.operations.safetyIncidents
                .filter(i => i.date === today && i.severity === 'major').length;
            
            document.getElementById('incidents-today').textContent = todayIncidents;
            
            // Calculate today's cost
            const todayCost = projectData.financial.dailyCosts
                .find(c => c.date === today)?.total || 2450;
            
            document.getElementById('cost-today').textContent = '$' + todayCost.toLocaleString();
        }
        
        function loadTechnicalData() {
            // Load survey data, quality tests, etc.
            // Implementation details...
        }
        
        function loadFinancialData() {
            // Calculate and display financial data
            const totalSpent = projectData.financial.expenses
                .reduce((sum, e) => sum + e.amount, 0);
            
            const remaining = projectData.projectInfo.totalBudget - totalSpent;
            const utilization = (totalSpent / projectData.projectInfo.totalBudget * 100).toFixed(1);
            
            // Update financial summary display
            // Implementation details...
        }
        
        // =================== MODAL OPERATIONS ===================
        
        function openSiteInspection() {
            openModal('site-inspection-modal');
        }
        
        function saveSiteInspection() {
            const inspection = {
                id: Date.now(),
                date: document.getElementById('inspection-time').value,
                weather: document.getElementById('weather-condition').value,
                tide: document.getElementById('tide-level').value,
                gps: {
                    lat: document.getElementById('gps-lat').value,
                    long: document.getElementById('gps-long').value
                },
                issues: document.getElementById('inspection-issues').value,
                actions: document.getElementById('corrective-actions').value,
                signature: getSignatureData(),
                timestamp: new Date().toISOString()
            };
            
            projectData.operations.inspections.unshift(inspection);
            saveComprehensiveData();
            closeModal();
            showToast('‚úÖ Site inspection saved successfully', 'success');
        }
        
        function openWorkerAttendance() {
            openModal('worker-attendance-modal');
            loadWorkerList();
        }
        
        function saveWorkerAttendance() {
            const attendance = {
                id: Date.now(),
                date: document.getElementById('attendance-date').value,
                presentWorkers: getPresentWorkers(),
                hours: document.getElementById('hours-worked').value || 8,
                overtime: document.getElementById('overtime-hours').value || 0,
                notes: document.getElementById('attendance-notes').value,
                totalCost: calculateDailyWages(),
                timestamp: new Date().toISOString()
            };
            
            projectData.labor.attendance.unshift(attendance);
            
            // Update payroll
            projectData.financial.expenses.push({
                type: 'labor',
                date: attendance.date,
                amount: attendance.totalCost,
                description: 'Daily wages for ' + attendance.presentWorkers.length + ' workers'
            });
            
            saveComprehensiveData();
            closeModal();
            loadOperationsData();
            showToast('üë∑ Worker attendance saved', 'success');
        }
        
        // =================== UTILITY FUNCTIONS ===================
        
        function saveComprehensiveData() {
            localStorage.setItem('kanditheemu_project_data', JSON.stringify(projectData));
        }
        
        function updateRealTimeData() {
            // Update time, weather, tide information
            const now = new Date();
            
            // Calculate tide based on location and time (simplified)
            const tideLevel = calculateTide(now);
            
            // Update display
            const timeString = now.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true 
            });
            
            // Update weather widget with tide info
            document.querySelector('.weather-widget .weather-condition').textContent = 
                `Partly Cloudy ‚Ä¢ Tide: ${tideLevel} @ ${timeString}`;
        }
        
        function calculateTide(date) {
            // Simplified tide calculation for Kanditheemu
            // In real app, use actual tide tables or API
            const hours = date.getHours();
            const minutes = date.getMinutes();
            const totalMinutes = hours * 60 + minutes;
            
            // Simplified: two high tides per day approximately
            const tide1High = 6 * 60; // 6:00 AM
            const tide1Low = 12 * 60; // 12:00 PM
            const tide2High = 18 * 60; // 6:00 PM
            const tide2Low = 0; // 12:00 AM
            
            if (Math.abs(totalMinutes - tide1High) < 90) return "High";
            if (Math.abs(totalMinutes - tide1Low) < 90) return "Low";
            if (Math.abs(totalMinutes - tide2High) < 90) return "High";
            if (Math.abs(totalMinutes - tide2Low) < 90) return "Low";
            
            // Calculate if rising or falling
            if ((totalMinutes > tide1High && totalMinutes < tide1Low) || 
                (totalMinutes > tide2High && totalMinutes < tide2Low + 24*60)) {
                return "Falling";
            } else {
                return "Rising";
            }
        }
        
        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        document.getElementById('gps-lat').value = position.coords.latitude.toFixed(6);
                        document.getElementById('gps-long').value = position.coords.longitude.toFixed(6);
                        showToast('üìç Location captured', 'success');
                    },
                    (error) => {
                        showToast('‚ùå Unable to get location', 'error');
                    }
                );
            } else {
                showToast('‚ùå Geolocation not supported', 'error');
            }
        }
        
        function initializeSignaturePad() {
            // Signature pad initialization code
            // Would use a library like Signature Pad in production
        }
        
        function getSignatureData() {
            // Get signature data from pad
            return "signature_data_placeholder";
        }
        
        function loadWorkerList() {
            // Load workers into attendance modal
            // Implementation details...
        }
        
        function getPresentWorkers() {
            // Get list of workers marked present
            return []; // Implementation details
        }
        
        function calculateDailyWages() {
            // Calculate total wages for the day
            const workers = getPresentWorkers();
            const hours = document.getElementById('hours-worked').value || 8;
            const overtime = document.getElementById('overtime-hours').value || 0;
            
            let total = 0;
            workers.forEach(worker => {
                const dailyRate = worker.rate || 25;
                total += dailyRate * (hours / 8);
                total += (dailyRate * 1.5) * (overtime / 8); // Overtime at 1.5x
            });
            
            return total;
        }
        
        function openEquipmentCheck() {
            showToast('üîß Equipment check feature opening...', 'info');
            // Implementation
        }
        
        function openQualityTests() {
            showToast('üß™ Quality tests feature opening...', 'info');
            // Implementation
        }
        
        function openProgressMeasurement() {
            showToast('üìè Progress measurement feature opening...', 'info');
            // Implementation
        }
        
        function openSafetyInspection() {
            showToast('üõ°Ô∏è Safety inspection feature opening...', 'info');
            // Implementation
        }
        
        function openEnvironmentalCheck() {
            showToast('üåø Environmental check feature opening...', 'info');
            // Implementation
        }
        
        function openDailyCosting() {
            showToast('üí∞ Daily costing feature opening...', 'info');
            // Implementation
        }
        
        function orderMaterial() {
            showToast('üì¶ Material order initiated', 'success');
            // Implementation
        }
        
        function scheduleService() {
            showToast('üîß Service scheduling initiated', 'success');
            // Implementation
        }
        
        function setWeather(weather) {
            document.getElementById('weather-condition').value = weather;
            showToast(`Weather set to ${weather}`, 'info');
        }
        
        function clearSignature() {
            // Clear signature pad
            showToast('Signature cleared', 'info');
        }
        
        function takeInspectionPhoto(type) {
            // In real app, use camera API
            showToast(`Taking ${type} photo...`, 'info');
        }
        
        function captureGPS() {
            getCurrentLocation();
        }
        
        function recordQCTest() {
            showToast('Recording quality test...', 'info');
            // Implementation
        }
        
        // =================== TOAST FUNCTION ===================
        
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal() {
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.classList.remove('active');
            });
        }
        
        function toggleCheck(element) {
            element.classList.toggle('checked');
            element.innerHTML = element.classList.contains('checked') ? '‚úì' : '';
        }
        
        // =================== EXPORT FUNCTIONS ===================
        
        // Export all functions to window object
        window.switchMainTab = switchMainTab;
        window.showOperationsSub = showOperationsSub;
        window.showTechnicalSub = showTechnicalSub;
        window.openSiteInspection = openSiteInspection;
        window.openWorkerAttendance = openWorkerAttendance;
        window.openEquipmentCheck = openEquipmentCheck;
        window.openQualityTests = openQualityTests;
        window.openProgressMeasurement = openProgressMeasurement;
        window.openSafetyInspection = openSafetyInspection;
        window.openEnvironmentalCheck = openEnvironmentalCheck;
        window.openDailyCosting = openDailyCosting;
        window.orderMaterial = orderMaterial;
        window.scheduleService = scheduleService;
        window.getCurrentLocation = getCurrentLocation;
        window.setWeather = setWeather;
        window.clearSignature = clearSignature;
        window.takeInspectionPhoto = takeInspectionPhoto;
        window.captureGPS = captureGPS;
        window.recordQCTest = recordQCTest;
        window.saveSiteInspection = saveSiteInspection;
        window.saveWorkerAttendance = saveWorkerAttendance;
        window.closeModal = closeModal;
        window.toggleCheck = toggleCheck;
    </script>
</body>
</html>
